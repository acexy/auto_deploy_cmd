#!/usr/bin/env node

var program = require('commander');
require('colour');

var path = require('path');

program
    .version(require(path.join(__dirname, '..', 'package.json')).version);

program
    .command('install')
    .alias('build')
    .arguments('[folderNames]')
    .description('\n        This command will use ' + '`mvn`'.yellow + ' to build java project\n' +
        '   If you want to use more folder, you can use `;` to join them\n' +
        '   use ' + '`deploy install --help`'.green + ' to get more information\n')
    .action(function (folderNames) {
        require('../command/install').install(folderNames);
    }).on('--help', function () {
    console.log('   Examples:'.blue);
    console.log();
    console.log('       $: deploy install > Build current dir project'.blue);
    console.log('       $: deploy install folderNameA;folderNameB > Build projects of folderNameA and folderNameB'.blue);
});

program
    .command('upgradeVersion')
    .alias('upV')
    .arguments('<version>')
    .description('\n        This command will bulk changes the current directory all projects\'s `pom.xml` version number\n')
    .action(function (version) {
        require('../command/upgradeVersion').upgradeVersion(version);
    }).on('--help', function () {
    console.log('   Examples:'.blue);
    console.log();
    console.log('       $: upVer 1.1.1 > To upgrade the `pom.xml` version number to 1.1.1'.blue);
});

program
    .command('publish')
    .alias('pub')
    .arguments('<folerNames> <env>')
    .description('\n        This command will be released in the folder you specify engineering resources to the `deployment server`\n' +
        '   If you want to use more folder, you can use `;` to join them\n' +
        '   use ' + '`deploy pub --help`'.green + ' to get more information\n')
    .action(function (folderNames, env) {
        require('../command/publish').publish(folderNames, env);
    }).on('--help', function () {
    console.log('   Examples:'.blue);
    console.log();
    console.log('       $: deploy pub folderName funpay/dev/order > Publish `folderName` project to funpay/dev/order'.blue);
    console.log('       $: deploy pub folderNameA;folderNameB funpay/dev/order > Publish `folderNameA` and `folderNameB` to project to funpay/dev/order'.blue);
});

program.parse(process.argv);

var cmd = program.args;
if (cmd.length == 0) {
    process.stdout.write(program.helpInformation());
} else if (typeof cmd[1] != 'object') {
    process.stdout.write(program.helpInformation());
}
